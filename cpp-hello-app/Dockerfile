# Тут стадия сборки

# Берем компилятор (gcc) и помечаем тегом builder
FROM gcc:12 AS builder 
# Определяем путь к рабочей директории внутри контейнера (куда положить исполняемый файл)
WORKDIR /app
# Копируем все что набилдили в рабочую директорию
COPY . .
# Запускаем наше приложение 
RUN g++ -static -o myapp main.cpp

# Теперь стадия запуска

# Для оптимизации размера образа выбираем alpine
FROM alpine:latest
WORKDIR /app
# С помощью тега копируем из рабочей директории исполянемый файл (myapp)
COPY --from=builder /app/myapp .
# Выполняем myapp
CMD ["./myapp"]
